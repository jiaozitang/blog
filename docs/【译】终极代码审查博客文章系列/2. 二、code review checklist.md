> 原文：https://www.michaelagreiler.com/code-review-checklist-2/

## 代码审查清单——关注重要问题

使用代码审查清单关注要点
代码审查清单以及围绕代码审查的明确规则和指南至关重要。代码审查清单可以使您的代码审查实践对您的团队更加有益，并显着加快代码审查速度。

研究表明，使用检查表的代码审查员胜过不使用检查表的代码审查员。因此，无论您是新开发人员还是经验丰富的开发人员，都可以考虑使用代码审查清单。

你可以在 Github 上找到我在我的代码审查研讨会中使用的清单。

## 做你自己的代码审查员

代码审查清单不仅适用于代码审查人员。相反，随着代码的作者发生变化，请遵循代码审查最佳实践并首先成为您自己的审查者！

因此，在发送代码进行审核之前，请确保：

- 代码编译并通过静态分析，没有警告
- 代码通过所有测试（单元、集成和系统测试）
- 您已经仔细检查了拼写错误并进行了清理（评论、待办事项等）
- 您概述了此更改的内容，包括更改的原因和更改的内容
- 除此之外，作为代码作者，您应该通过与审阅者相同的代码审查清单。

## 代码审查员的代码审查清单

作为代码审查员，您的任务是首先 寻找最重要的问题。吹毛求疵更容易 挂断电话。但是，这样不好。

在我们在 Microsoft 进行的一项大型研究中，我们调查了出色的代码审查反馈是什么样的。我们清楚地看到，揭示更大的结构或逻辑问题的评论被认为比关注小问题的评论更有价值。

这就是代码审查清单发挥作用的地方。一份出色的清单将您的注意力引导到重要和最有价值的问题上。下面是我在代码审查研讨会期间使用的清单。它分为十个独立的部分。每个部分都会引导您完成几个问题。那么，让我们开始吧：

### 执行

- 此代码更改是否完成了它应该做的事情？
- 这个解决方案可以简化吗？
- 此更改是否添加了不需要的编译时或运行时依赖项？
- 是否使用了不应使用的框架、API、库、服务？
- 是否没有使用可以改进解决方案的框架、API、库、服务？
- 代码是否处于正确的抽象级别？
- 代码是否足够模块化？
- 您是否会以在代码的可维护性、可读性、性能和安全性方面更好的不同方式解决问题？
- 代码库中是否已经存在类似的功能？如果是这样，为什么不重用此功能？
- 是否有任何最佳实践、设计模式或特定于语言的模式可以显着改进此代码？
- 这段代码是否遵循面向对象的分析和设计原则，如单一职责原则、开闭原则、Liskov 替换原则、接口隔离、依赖注入？

### 逻辑错误和错误

- 您能想到代码未按预期运行的任何用例吗？
- 你能想到任何可能破坏代码的输入或外部事件吗？

### 错误处理和记录

- 错误处理是否以正确的方式完成？
- 是否应该添加或删除任何日志记录或调试信息？
- 错误消息对用户友好吗？
- 是否有足够的日志事件，它们是否以易于调试的方式编写？

### 可用性和可访问性

- 从可用性的角度来看，提议的解决方案是否设计良好？
- API 是否有据可查？
- 建议的解决方案 (UI) 是否可访问？
- API/UI 使用起来是否直观？

### 伦理道德

- 此更改是否以可能引发隐私问题的方式使用用户数据？
- 这种变化是否利用了行为模式或人类弱点？
- 代码或它启用的功能是否会对（某些）用户造成精神和身体伤害？
- 如果规范增加或改变了人们相互交流的方式，是否有适当的措施来防止/限制/报告骚扰或虐待？
- 这种变化是否会导致排除特定人群或用户？
- 此代码更改是否引入了任何算法、人工智能或机器学习偏见？
- 此代码更改是否引入了任何性别/种族/政治/宗教/能力主义者偏见？

### 测试和可测试性

- 代码是否可测试？
- 它是否有足够的自动化测试（单元/集成/系统测试）？
- 现有的测试是否合理地涵盖了代码更改？
- 是否有一些测试用例、输入或边缘用例需要额外测试？

### 依赖项

- 如果此更改需要在代码之外进行更新，例如更新文档、配置、自述文件，是否已完成？
- 这种变化是否会对系统的其他部分产生任何影响，向后兼容？
- 安全和数据隐私
- 此代码是否会针对安全漏洞打开软件？
- 授权和身份验证是否以正确的方式处理？
- 用户数据、信用卡信息等敏感数据是否得到安全处理和存储？是否使用了正确的加密？
- 此代码更改是否会泄露一些秘密信息（如密钥、用户名等）？
- 如果代码处理用户输入，它是否解决了跨站点脚本、SQL 注入等安全漏洞，它是否进行输入清理和验证？
- 从外部 API 或库中检索的数据是否进行了相应检查？

### 表现

- 您是否认为此代码更改会对系统性能产生负面影响？
- 您是否看到任何提高代码性能的潜力？

### 可读性

- 代码容易理解吗？
- 哪些部分让您感到困惑，为什么？
- 可以通过更小的方法来提高代码的可读性吗？
- 代码的可读性可以通过不同的函数/方法或变量名来提高吗？
- 代码是否位于正确的文件/文件夹/包中？
- 你认为某些方法应该被重组以拥有更直观的控制流程吗？
- 数据流是否可以理解？
- 是否有多余的评论？
- 一些评论能否更好地传达信息？
- 更多注释会使代码更易于理解吗？
- 是否可以通过使代码本身更具可读性来删除一些注释？
- 有没有注释掉的代码？

### 专家意见

- 您认为特定专家（例如安全专家或可用性专家）是否应该在提交代码之前对其进行检查？
- 此代码更改会影响不同的团队吗？他们也应该对变革有发言权吗？

嗯，就是这样。您查看并考虑了最紧迫的问题。恭喜！

现在，我在代码审查研讨会中进行的一项练习是通过回答三个问题与参与者一起反映代码审查清单：

- 您最关注代码审查清单的哪些部分？
- 你倾向于忽略哪些部分？
- 你认为其中一些点比其他点更重要吗？为什么？

但是编码风格和约定呢？
也许在这个练习中，你意识到我没有检查代码是否遵循正确的编码风格。那么，这不重要吗？

简短的回答：这很重要。清晰的编码风格指南是在代码库中强制执行一致性的唯一方法。而且，一致性使代码审查更快，允许人们轻松更改项目，并使您的代码库保持可读性和可维护性。

谷歌就是这样做的一个很好的例子。这无疑让 Google 拥有了最快的代码审查周转时间之一。

作为起点，我建议使用 Google 为多种语言提供的现成编码样式。

**制定基本规则很重要，但请确保一劳永逸地做到这一点。不要持续争论它。**

清晰的编码风格可以加快您的代码审查。但是，只有当您通过工具自动执行它们时。点击推文
自动化可以自动化的东西
但是，一旦您决定了代码库的外观，请花时间正确安装和配置工具，以便代码格式化成为按下按钮的问题。

此外，您还可以做更多事情。使用静态分析工具来腾出人工代码审查员的时间。最初的努力是值得的。

不要让您的审阅者检查工具可以检测到更可靠和更具成本效益的问题。

**尊重、谦虚和善良**

最后，代码审查反馈的质量不仅取决于你在说什么，还取决于你怎么说。
因此，如果没有仔细措辞、谦虚和友善，最好的代码审查反馈就毫无价值。
首先，将您的反馈表述为建议而不是要求。
例如，不要写“变量名应该是 removeObject ”。说“调用变量 removeObject 怎么样？”。
